---
title: "Troj/JSRedir-AK: 40% of a month’s malware"
date: 2010-01-25T22:37:00+00:00
layout: single
author_profile: true
url: 2010/01/25/trojjsredir-ak-40-of-a-months-malware/
tags:
  - alert
  - malware
  - report
lang: en
category: techblog
---
It has been a month since Sophos added detection for Troj/JSRedir-AK and figures generated today show that over 40% of all web-based detections have been from this malicious code.

<div>
  <a href="http://3.bp.blogspot.com/_vaUVXcmC3OI/S14Vf-CzbgI/AAAAAAAAAwI/9YvVqXMcP1c/s1600-h/manhattan1.jpg" imageanchor="1"><img border="0" src="http://3.bp.blogspot.com/_vaUVXcmC3OI/S14Vf-CzbgI/AAAAAAAAAwI/9YvVqXMcP1c/s640/manhattan1.jpg" /></a>
</div>

[Graph shows Malware hosted on websites from 2009-12-22 11:00:00 to 2010-01-21 11:00:00 (GMT-8)]

Translating the numbers into a more human comprehensible form: 1 site every 15 secs was being detected as Troj/JSRedir-AK.

The affected sites include well-known names, including:



  * Energy Companies
  * Retail Companies
  * Automobile Club
  * Hotels

Using the JavaScript .replace the malware deobfuscates itself and dynamically writes an iframe point to a Russian website on port 8080 which serves up scripts detected as Troj/Iframe-DL.

This new script will write an iframe that will attempt to load a PDF (detected as Troj/PDFJs-FY) and a file claiming to be a JPG (detected as Exp/VidCtl-A). These then will install various other malware.

Troj/JSRedir-AK is a continuation of the Gumblar gang’s exploits using Russian domains instead of Chinese ones. In fact, the graph above is very similar to the one we saw for Troj/JSRedir-R and the infection mechanisms seem to be the same (i.e. FTP credentials).