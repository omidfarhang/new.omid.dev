---
title: W32.Yimfoca.B â€“ Malware Localization
date: 2010-12-06T22:03:00+00:00
layout: single
author_profile: true
url: 2010/12/06/w32-yimfoca-b-malware-localization/
tags:
  - malware
  - review
  - Yahoo
lang: en
categories: 
  - techblog
---
The latest W32.Yimfoca.B variants can target malicious links in no fewer than 44 countries and nearly 20 different languages. It has also increased the number of instant messaging applications (previously Yahoo! Messenger) to include the following popular IM clients:

  * Msn Messenger
  * Google Talk
  * ICQ
  * Paltalk
  * Skype
  * XFire

Here is a code snippet from W32.Yimfoca.B:

[<img title="Blog1_1" border="0" alt="Blog1_1" src="http://lh4.ggpht.com/_vaUVXcmC3OI/TP1WeefxMAI/AAAAAAAADYc/cRd4LPj1338/Blog1_1_thumb%5B1%5D.jpg?imgmax=800" width="504" height="203" />](http://lh6.ggpht.com/_vaUVXcmC3OI/TP1WcqSe2CI/AAAAAAAADYY/AQrN19z3un0/s1600-h/Blog1_1%5B3%5D.jpg)

This picks the desired messages based on a comparison with the full list of countries listed below:

Â·Â Â Â Â Â Â Â Â  Slovenia

Â·Â Â Â Â Â Â Â Â  Canada

Â·Â Â Â Â Â Â Â Â  Norway

Â·Â Â Â Â Â Â Â Â  Switzerland (German)

Â·Â Â Â Â Â Â Â Â  Switzerland (Romansh)

Â·Â Â Â Â Â Â Â Â  United Kingdom

Â·Â Â Â Â Â Â Â Â  Mexico

Â·Â Â Â Â Â Â Â Â  Belgium

Â·Â Â Â Â Â Â Â Â  Austria

Â·Â Â Â Â Â Â Â Â  Portugal

Â·Â Â Â Â Â Â Â Â  Australia

Â·Â Â Â Â Â Â Â Â  Spain (Modern)

Â·Â Â Â Â Â Â Â Â  Spain (Traditional)

Â·Â Â Â Â Â Â Â Â  Venezuela

Â·Â Â Â Â Â Â Â Â  New Zealand

Â·Â Â Â Â Â Â Â Â  Ireland

Â·Â Â Â Â Â Â Â Â  South Africa

Â·Â Â Â Â Â Â Â Â  Colombia

Â·Â Â Â Â Â Â Â Â  Peru

Â·Â Â Â Â Â Â Â Â  Argentina

Â·Â Â Â Â Â Â Â Â  Turkey

Â·Â Â Â Â Â Â Â Â  Pakistan

Â·Â Â Â Â Â Â Â Â  Indonesia

Â·Â Â Â Â Â Â Â Â  Ukraine

Â·Â Â Â Â Â Â Â Â  Belarus

Â·Â Â Â Â Â Â Â Â  Czech Republic

Â·Â Â Â Â Â Â Â Â  Denmark

Â·Â Â Â Â Â Â Â Â  Germany

Â·Â Â Â Â Â Â Â Â  Greece

Â·Â Â Â Â Â Â Â Â  United States

Â·Â Â Â Â Â Â Â Â  Finland

Â·Â Â Â Â Â Â Â Â  France

Â·Â Â Â Â Â Â Â Â  Israel

Â·Â Â Â Â Â Â Â Â  Hungary

Â·Â Â Â Â Â Â Â Â  Iceland

Â·Â Â Â Â Â Â Â Â  Italian

Â·Â Â Â Â Â Â Â Â  Japan

Â·Â Â Â Â Â Â Â Â  Korea

Â·Â Â Â Â Â Â Â Â  Netherlands

Â·Â Â Â Â Â Â Â Â  Polish

Â·Â Â Â Â Â Â Â Â  Brazil

Â·Â Â Â Â Â Â Â Â  Romania

Â·Â Â Â Â Â Â Â Â  Russia

Â·Â Â Â Â Â Â Â Â  Croatia

Â·Â Â Â Â Â Â Â Â  Slovakia

Â·Â Â Â Â Â Â Â Â  Albania

Â·Â Â Â Â Â Â Â Â  Sweden

Â·Â Â Â Â Â Â Â Â  Thailand

The full list of messages is:

Â·Â Â Â Â Â Â Â Â  mira esta fotografa ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  seen this?? ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  This is the funniest photo ever! [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  olhar para esta foto ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  Wie findest du das Foto? [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  se ps dette bildet ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  bekijk deze foto ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  poglej to fotografijo ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  pogledaj to slike ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  titta ps denna bild ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  pozrite sa na t

Â·Â Â Â Â Â Â Â Â  to fotografiu ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  uita-te la aceasta fotografie ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  katso tStS kuvaa ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  bu resmi bakmak ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  spojrzec na to zdjecie ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  nTzd meg a kTpet ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  ser ps dette billede ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  podfvejte se na mou fotku ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  guardare quest'immagine ðŸ˜€ [MALICIOUS LINK]

Â·Â Â Â Â Â Â Â Â  regardez cette photo ðŸ˜€ [MALICIOUS LINK]

When the worm doesnâ€™t recognize the country, it uses a default message in English:

Seen this?? ðŸ˜€ [MALICIOUS LINK]

Surely this will help with the success rate of its IM spreading capabilities, but it isnâ€™t finished thereâ€¦

W32.Yimfoca.B has also has the added capability to spread to any removable drives on C through Z. Upon initial infection, and every five minutes thereafter, W32.Yimfoca.B will attempt to infect removable drives inserted into the compromised computer.

When W32.Yimfoca.B infects these drives, it hides existing folders found on the removable drive, setting their attributes to â€˜systemâ€™ and â€˜hiddenâ€™, and replacing them with a shortcut link to a copy of the worm. The shortcut icon will be that of a folder, so a user may be fooled into thinking this is in fact the original folder.

Here is what a typical user will see if system files are hidden (which is the default):

[<img title="Blog2_1" border="0" alt="Blog2_1" src="http://lh6.ggpht.com/_vaUVXcmC3OI/TP1WhocikUI/AAAAAAAADYk/6zpJ5MORins/Blog2_1_thumb%5B1%5D.jpg?imgmax=800" width="504" height="275" />](http://lh6.ggpht.com/_vaUVXcmC3OI/TP1Wf_bJVvI/AAAAAAAADYg/W3RGmUIWauo/s1600-h/Blog2_1%5B3%5D.jpg)

Here is what really exists on an infected removable drive:

[<img title="blog3" border="0" alt="blog3" src="http://lh5.ggpht.com/_vaUVXcmC3OI/TP1Wky688OI/AAAAAAAADYs/Ljvdqmj2GiE/blog3_thumb%5B1%5D.jpg?imgmax=800" width="504" height="202" />](http://lh6.ggpht.com/_vaUVXcmC3OI/TP1WjPXQBQI/AAAAAAAADYo/NEyJSJE_ji0/s1600-h/blog3%5B3%5D.jpg)

The real purpose of the threat is to spread in order to download further malware on to your computer. At the time of analysis, this version of W32.Yimfoca.B is downloading W32.Yimfoca.